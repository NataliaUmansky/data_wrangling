<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>University of Lucerne  Digital Methods</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <meta name="description" content="Data wrangling"/>
    <meta name="generator" content="xaringan and remark.js"/>
    <meta name="github-repo" content="nataliaumansky/xxx"/>
    <meta name="twitter:title" content="Data wrangling"/>
    <meta name="twitter:description" content="Data wrangling"/>
    <meta name="twitter:url" content="nataliaumansky.github.io"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:creator" content="@NataliaUmansky"/>
    <meta name="twitter:site" content="@NataliaUmansky"/>
    <meta property="og:title" content="Data wrangling"/>
    <meta property="og:description" content="Data wrangling"/>
    <meta property="og:url" content="nataliaumansky.github.io"/>
    <meta property="og:type" content="website"/>
    <meta property="og:locale" content="en_US"/>
    <meta property="article:author" content="Natalia Umansky"/>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/lexis.css" type="text/css" />
    <link rel="stylesheet" href="css/lexis-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

layout: true

&lt;style&gt;
.onehundredtwenty {
  font-size: 120%;
   }

&lt;style&gt;
.ninety {
  font-size: 90%;
   }

.eightyfive {
  font-size: 85%;
   }
   
.eighty {
  font-size: 80%;
   }
   
.seventyfive {
  font-size: 75%;
   }
   
.seventy {
  font-size: 70%;
   }
   
.fifty {
  font-size: 50%;
   }
   
.forty {
  font-size: 40%;
   }
&lt;/style&gt;







---
name: title-slide
class: primary


#.fira[University of Lucerne&lt;br&gt; Digital Methods] 

###.fancy[Data wrangling and &lt;br&gt;visualization with tidyverse]


&lt;br&gt;



Natalia Umansky &lt;br&gt; .small[University of Zurich]

[<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> @NataliaUmansky](http://twitter.com/NataliaUmansky)&lt;br&gt;
[<svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> @NataliaUmansky](http://github.com/NataliaUmansky)&lt;br&gt;
[<svg aria-hidden="true" role="img" viewBox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"/></svg> nataliaumansky.github.io](http://nataliaumansky.github.io)


April 27 2024

.fifty[Link to slides: [nataliaumansky.github.io/data_wrangling_2](https://nataliaumansky.github.io/data_wrangling_2)]

---
## .fancy[Schedule]

|When?                           | What?                              | 
|:-------------------------------|-----------------------------------:|
|9:30 - 10:30                    |Revision &amp; presentations                           |
|10:30 - 10:45                   |Coffee break                        |
|10:45 - 12:15                   |Data visualization with `ggplot2` I |
|12:15 - 13:15                   |Lunch                               |
|13:15 - 14:45                   |Data visualization with `ggplot2` II|
|14:45 - 15:00                   |Coffee break                        |
    
---
class: primary

## What is ggplot2?





.pull-left[
An R package that is part of the `tidyverse` specifically designed for the creation of plots 
]



---
class: secondary




---
## Data: `palmerpenguins` R package

Contains size measurements for three penguin species observed on three islands in the Palmer Archipelago, Antarctica.


|species | body_mass_g| bill_length_mm|sex    |
|:-------|-----------:|--------------:|:------|
|Adelie  |        3750|           39.1|male   |
|Adelie  |        3800|           39.5|female |
|Adelie  |        3250|           40.3|female |
|Adelie  |        3450|           36.7|female |
|Adelie  |        3650|           39.3|male   |
|Adelie  |        3625|           38.9|female |


---
class: center, middle
## So.. what's the gg in `ggplot2`?

&lt;br&gt;

#`ggplot2` is the .fancy[**g**rammar of **g**raphics **plot**]... 


---
## .fancy[Grammar of Graphics]

* "Grammar of graphics is a tool that enables us to concisely describe the components of a graphic" .orange[.small[The Grammar of Graphics by Leland Wilkinson]]


* Proposed an idea of building up a graphic from multiple "layers of data" 


* "Layers" implemented in `ggplot2` (with some tweaks and expansion on the concept)

---
class: tertiary

---
## .fancy[Grammar of Graphics] - Essentials


.pull-left[
**Data**

```r
library(tidyverse)

ggplot( )
```
]

.pull-right[
`ggplot()` requires your data to be 'tidy'
* Every variable has a column
* Every observation has a row
]

---
## .fancy[Grammar of Graphics] - Essentials


.pull-left[
**Data**

```r
library(tidyverse)

ggplot(data = penguins)

penguins %&gt;% 
  ggplot()
```
]

.pull-right[
`ggplot()` requires your data to be 'tidy'
* Every variable has a column
* Every observation has a row
]

---

## .fancy[Grammar of Graphics] - Essentials

.leftcol55[

```r
library(tidyverse)

ggplot(data = penguins)
```
]

.rightcol45[
&lt;img src="figs/unnamed-chunk-1-1.png" width="522.144" /&gt;
]

---

## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Mapping**

```r
library(tidyverse)

ggplot(data = penguins) +
aes(x = , 
    y = )
```
]

.rightcol45[
Crosswalk between variables in the dataset and how they are visualized in the plot

]

---
## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Mapping**

```r
library(janitor)
library(tidyverse)

penguins %&gt;% #data
clean_names() %&gt;% #clean variable names
ggplot() + #creating plot object
  aes(x = body_mass_g, y = flipper_length_mm) #mapping
```
]

.rightcol45[
Crosswalk between variables in the dataset and how they are visualized in the plot
* .red[X] = body mass g; 
* .red[Y] = flipper length mm; 
]

---

## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Mapping**

```r
library(janitor)
library(tidyverse)

penguins %&gt;% #data
clean_names() %&gt;% #clean variable names
ggplot() + #creating plot object
  aes(x = body_mass_g, y = flipper_length_mm) #mapping
```
]

.rightcol45[
Crosswalk between variables in the dataset and how they are visualized in the plot
* .red[X] = body mass g; 
* .red[Y] = flipper length mm; 

&lt;img src="figs/unnamed-chunk-2-1.png" width="522.144" /&gt;
]

---

## .fancy[Grammar of Graphics] - Essentials

.pull-left[
**Geometric Object**

```r
geom_*()
```
]

.pull-right[
Controls the type of plot you create

* `geom_point()` = scatter plot

* `geom_line()` = line plot

* `geom_col()` or `geom_bar()` = bar graph

...**and more**!!!
]

---

## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Geometric Object**

```r
library(janitor)
library(tidyverse)

penguins %&gt;% #data
clean_names() %&gt;% #clean variable names
ggplot() + #creating plot object
  aes(x = body_mass_g, y = flipper_length_mm) #mapping
    geom_point() #geometric object   
```
]

.rightcol45[

&lt;br&gt;

&lt;img src="figs/unnamed-chunk-3-1.png" width="130%" height="170%" /&gt;

]


---

&lt;center&gt;

.font180[.fancy[Now it's your turn to write some R code!]]

&lt;br&gt;&lt;br&gt;

&lt;br&gt;

&lt;img src="https://media1.tenor.com/images/72bf7922ac0b07b2f7f8f630e4ae01d2/tenor.gif?itemid=11364811" style="width: 50%"/&gt;
&lt;/center&gt;

---


.pull-left[

.font100[.fira[Task 1]]

.font60[Load the `tidyverse` and `janitor` packages.

&gt; If `tidyverse` or `janitor` packages are not installed yet (it will
&gt; say `[package] not found`). Your first task, is then to install them.
&gt; Note: this might take you a little bit of time.]

&lt;br&gt;

.font100[.fira[Task 2]]

.font60[Read in the already cleaned `palmerpenguins` data set using

* `read_csv`
* the following URL:
    [https://raw.githubusercontent.com/allisonhorst/palmerpenguins/main/inst/extdata/penguins.csv](https://raw.githubusercontent.com/allisonhorst/palmerpenguins/master/inst/extdata/penguins.csv)

Assign the resulting data to `penguins`.

]]

.pull-right[

.font100[.fira[Task 3]]

.font60[Create a lineplot with .red[x = body_mass_g], &lt;br&gt; .red[y = flipper_length_mm]]

.font100[.fira[Task 4]]

.font60[Create a barplot with .red[x = species], .red[y = body_mass_g. .red[Hint] you might need to use geom_col()]]

]

---
class: spoiler
---

###Solution

.pull-left[

.code50[

```r
penguins &lt;- read_csv("https://raw.githubusercontent.com/allisonhorst/palmerpenguins/main/inst/extdata/penguins_raw.csv")

library(janitor)
library(tidyverse)
penguins %&gt;% 
clean_names() %&gt;% 
ggplot() +
  aes(x = body_mass_g, y = flipper_length_mm) +
    geom_line()   
```

&lt;img src="figs/unnamed-chunk-4-1.png" width="130%" height="170%" /&gt;

]]

.pull-right[
.code50[

```r
penguins &lt;- read_csv("https://raw.githubusercontent.com/allisonhorst/palmerpenguins/main/inst/extdata/penguins_raw.csv")

library(janitor)
library(tidyverse)
penguins %&gt;% 
clean_names() %&gt;% 
ggplot() +
  aes(x = species, y = body_mass_g) +
    geom_col()   
```

&lt;img src="figs/unnamed-chunk-5-1.png" width="130%" height="170%" /&gt;

]]

---
## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Mapping + Geometric Object**

```r
# Method 1 
ggplot(data = penguins,
       aes(x = body_mass_g, 
           y = bill_length_mm))
       
# Method 2
ggplot(data = penguins) +
  geom_point(aes(x = body_mass_g, 
           y = bill_length_mm))

# Method 3
ggplot() +
  geom_point(data = penguins,
         aes(x = body_mass_g, 
           y = bill_length_mm))
```
]

.rightcol45[
.font90[
**Method 1**: Best when using one data set and one aesthetic mapping

**Method 2**: Best when using one data set, and multiple geoms + aesthetic mappings

**Method 3**: Best when using multiple data sets, and multiple geoms + aesthetic mappings
]]

---

## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Geometric Object**

```r
library(janitor)
library(tidyverse)

penguins %&gt;% #data
clean_names() %&gt;% #clean variable names
ggplot() + #creating plot object
  aes(x = body_mass_g, y = flipper_length_mm) #mapping
    geom_point() #geometric object   
```
]

.rightcol45[
Understands the following aesthetics
.font90[
* x
* y
* alpha
* colour
* fill
* shape
* size
* etc.
]]


---

## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Geometric Object**

```r
library(janitor)
library(tidyverse)

penguins %&gt;% #data
clean_names() %&gt;% #clean variable names
ggplot() + #creating plot object
  aes(x = body_mass_g, y = flipper_length_mm,
      colour = sex) #mapping
    geom_point() #geometric object   
```
]

.rightcol45[

Add another dimension to the plot by using `colour = `

&lt;img src="figs/unnamed-chunk-6-1.png" width="130%" height="170%" /&gt;

]

---

## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Geometric Object**

```r
library(janitor)
library(tidyverse)

penguins %&gt;% #data
clean_names() %&gt;% #clean variable names
ggplot() + #creating plot object
  aes(x = body_mass_g, y = flipper_length_mm) #mapping
    geom_point(aes(shape = as.factor(sex))) #geometric object   
```
]

.rightcol45[

Change the shape of the scatter plot, by using `aes()` ans `shape=`

&lt;img src="figs/unnamed-chunk-7-1.png" width="130%" height="170%" /&gt;

]

---

## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Geometric Object**

```r
library(janitor)
library(tidyverse)

penguins %&gt;% #data
clean_names() %&gt;% #clean variable names
ggplot() + #creating plot object
  aes(x = body_mass_g, y = flipper_length_mm) #mapping
    geom_point(colour = "blue") #geometric object   
```
]

.rightcol45[

Map an aesthetic to a fixed value, by calling it .red[outside] of `aes()`

&lt;img src="figs/unnamed-chunk-8-1.png" width="130%" height="170%" /&gt;

]

---

## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Geometric Object**

```r
library(janitor)
library(tidyverse)

penguins %&gt;% #data
clean_names() %&gt;% #clean variable names
ggplot() + #creating plot object
  aes(x = body_mass_g, y = flipper_length_mm) + #mapping
    geom_point(shape = 21,
            colour = "blue",
            fill = "red") #geometric object   
```
]

.rightcol45[

For shapes (or geoms) that have a border you can make the border (`colour`) and the inside (`fill`) different colors. 

&lt;img src="figs/unnamed-chunk-9-1.png" width="130%" height="170%" /&gt;

]

---


class: center, middle, inverse

## Exercise

---
.pull-left[
.font150[.fira[Task 5]]

.font60[Within the same plot, create a scatter plot AND a smoothed line

.red[Hint] you will need to first use `geom_point()` and then `geom_smooth()`]

.font150[.fira[Task 6]]

.font60[Recreate the previous plot and this time color the scatter plot by sex]]

.pull-right[

.font150[.fira[Task 7]]

.font60[Repeat .fira[Task 6] but this time remove all observations that have `sex = NA`

.red[Hint] you might want to use some of the `tidyverse`functions we discussed yesterday
]]

---
class: spoiler

---
### Solution

.pull-left[

.code50[

```r
penguins &lt;- read_csv("https://raw.githubusercontent.com/allisonhorst/palmerpenguins/main/inst/extdata/penguins_raw.csv")

library(janitor)
library(tidyverse)
penguins %&gt;% 
clean_names() %&gt;% 
ggplot() +
  aes(x = body_mass_g, y = flipper_length_mm) +
    geom_point(aes(colour = as.factor(sex)))+
  geom_smooth()
```

&lt;img src="figs/unnamed-chunk-10-1.png" width="130%" height="170%" /&gt;

]]

.pull-right[
.code50[

```r
penguins &lt;- read_csv("https://raw.githubusercontent.com/allisonhorst/palmerpenguins/main/inst/extdata/penguins_raw.csv")

library(janitor)
library(tidyverse)
penguins %&gt;% 
clean_names() %&gt;%
filter(!is.na(sex)) %&gt;% 
ggplot() +
  aes(x = body_mass_g, y = flipper_length_mm) +
    geom_point(aes(colour = as.factor(sex)))+
  geom_smooth()  
```

&lt;img src="figs/unnamed-chunk-11-1.png" width="130%" height="170%" /&gt;

]]

---
class: lunch

---
## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Labels**

```r
library(janitor)
library(tidyverse)

penguins %&gt;% #data
clean_names() %&gt;% #clean variable names
ggplot() + #creating plot object
  aes(x = body_mass_g, y = flipper_length_mm) + #mapping
    geom_point(colour = "blue") + #geometric object 
    xlab("Body Mass (g)") +
    ylab("Bill Length (mm)")
```
]

.rightcol45[

You can change the labels of the axes, as well as modify the limits of the axes.  

This is done by using:
* `xlab()` and `ylab()` to change the labels
* `xlim()` and `ylim()` to change the limits

.font60[.gray[Note this can also be done by using `labs()` - to be covered later!]]]

---
## .fancy[Grammar of Graphics] - Essentials

.leftcol55[
**Labels**

```r
library(janitor)
library(tidyverse)

g &lt;- penguins %&gt;% #data
clean_names() %&gt;% #clean variable names
ggplot() + #creating plot object
  aes(x = body_mass_g, y = flipper_length_mm) + #mapping
    geom_point(colour = "blue")  #geometric object 


g + xlab("Body Mass (g)") +
    ylab("Bill Length (mm)")

```
]

.rightcol45[

You can change the labels of the axes, as well as modify the limits of the axes.  

This is done by using:
* `xlab()` and `ylab()` to change the labels
* `xlim()` and `ylim()` to change the limits

.font60[.gray[Note this can also be done by using `labs()` - to be covered later!]]]

---
## .fancy[Grammar of Graphics] - Facets 

.pull-left[

Generates small multiples that each show a different subset of the data
Alternative to aesthetics for displaying additional categorical/discrete variables

Two `facet_*()` options:

`facet_grid()` and `facet_wrap()`]

.pull-right[

&lt;img src="figs/unnamed-chunk-12-1.png" width="130%" height="170%" /&gt;


]

---

## .fancy[Grammar of Graphics] - Facets 

.leftcol40[

Generates small multiples that each show a different subset of the data
Alternative to aesthetics for displaying additional categorical/discrete variables

Two `facet_*()` options:

`facet_grid()` and `facet_wrap()`]

.rightcol60[



```r

g + facet_wrap(~species)

```

&lt;img src="figs/unnamed-chunk-13-1.png" width="130%" height="170%" /&gt;


]

---
## .fancy[Grammar of Graphics] - Facets 

.leftcol40[

Generates small multiples that each show a different subset of the data
Alternative to aesthetics for displaying additional categorical/discrete variables

Two `facet_*()` options:

`facet_grid()` and `facet_wrap()`]

.rightcol60[



```r

g + facet_grid(row = vars(species),
               cols = vars(year))

```

&lt;img src="figs/unnamed-chunk-14-1.png" width="130%" height="170%" /&gt;


]

---

## .fancy[Grammar of Graphics] - Facets 

Note that for the previous example I had to use `tidyverse` to create the .fancy[year] variable and then `ggplot2`

```r

penguins &lt;- read_csv("https://raw.githubusercontent.com/allisonhorst/palmerpenguins/main/inst/extdata/penguins_raw.csv")

library(janitor)
library(tidyverse)
penguins %&gt;% 
clean_names() %&gt;% 
  mutate(year= format(as.Date(date_egg, format="%Y-%m-%d"),"%Y")) %&gt;% 
ggplot() +
  aes(x = body_mass_g, y = flipper_length_mm) +
    geom_point(shape = 21,
            colour = "blue",
            fill = "red")+
  facet_grid(row = vars(species),
               cols = vars(year))

```
---
## .fancy[Honorable Mentions] - Labs

.pull-left[
Labs allow you to change the labels of the plot 

```r
g +
  labs(x = "Body Mass (g)",
       y = "Bill Length (mm)",
       title = "Palmer Penguins",
       subtitle = "Bill Length (mm) vs. Body Mass (g)",
       caption = "Created by Natalia Umansky")
```
This is similar to `xlab()` and `ylab()` but contained in one function
]
.pull-right[


&lt;br&gt;

&lt;img src="figs/unnamed-chunk-15-1.png" width="130%" height="170%" /&gt;
]

---

## .fancy[Honorable Mentions] - Themes

.pull-left[
Control the plot appearance/decorations


```r
g + theme_minimal()
```
]

.pull-right[
&lt;img src="figs/unnamed-chunk-16-1.png" width="130%" height="170%" /&gt;
]
---

## .fancy[Honorable Mentions] - Themes

.pull-left[
You can customize your own `theme()`

.code70[
```r
g + 
  facet_grid(row = vars(species),
               cols = vars(year)) +
  theme(
    plot.background = element_blank(),
    panel.background = 
      element_rect(fill = "white"),
    panel.grid = 
      element_line(colour = "grey"),
    strip.background = 
      element_rect(fill = "black"),
    strip.text = 
      element_text(face = "bold",
                  colour = "white",
                  size = 13))
```
]]

.pull-right[

&lt;br&gt;&lt;br&gt;

&lt;img src="figs/unnamed-chunk-17-1.png" width="130%" height="170%" /&gt;
]

---


class: center, middle, inverse

## Exercise

---
.pull-left[
.font150[.fira[Task 8]]

.font60[Create a plot that...

* shows penguin body mass on the `x` axis
* shows flipper length on the `y` axis
* uses `sex` as colour for the geometric objects
* removes NAs
* is a scatterplot but uses a geometric object that is not the standar circle
* shows a smoothed line over the scatterplot
* is faceted by year and species
* displays nicely formatted labs (i.e., labels, legends, title, and caption)
* uses `theme_light()`
]]

.pull-right[

.font150[.fira[Task 9]]

.font60[Install the `ggbeeswarm` package using `install.packages("ggbeeswarm")`

Create a plot that...

* shows penguin species on the `x` axis
* shows culmen length (mm) on the `y` axis
* removes NAs
* uses `geom_boxplot()` to display boxplots with red outlines
* uses the `ggbeeswarm` and `geom_quasirandom()` to display a scatterplot on top of the boxplots, with an alpha = 0.1 (dot transparency)
* displays nicely formatted labs (i.e., labels, legends, title, and caption)
* uses `theme_light()`
]]

---

class: spoiler

---

###Solution

.pull-left[.code40[

```r
penguins &lt;- read_csv("https://raw.githubusercontent.com/allisonhorst/palmerpenguins/main/inst/extdata/penguins_raw.csv")

library(janitor)
library(tidyverse)
penguins %&gt;% 
clean_names() %&gt;% 
  mutate(year= format(as.Date(date_egg, format="%Y-%m-%d"),"%Y")) %&gt;% 
  filter(!is.na(sex)) %&gt;% 
ggplot() +
  aes(x = body_mass_g, y = flipper_length_mm) +
    geom_point(aes(colour=sex),shape = 17)+
  geom_smooth()+
  facet_grid(row = vars(species),
               cols = vars(year))+
  labs(x = "Body Mass (g)",
       y = "Bill Length (mm)",
       title = "Palmer Penguins",
       legend.title= "Sex",
       subtitle = "Bill Length (mm) vs. Body Mass (g)",
       caption = "Created by Natalia Umansky",
       color='Sex')+
  theme_light()

```

]]

.pull-right[

&lt;img src="figs/unnamed-chunk-18-1.png" width="130%" height="170%" /&gt;


]

---
###Solution

.pull-left[.code40[

```r
penguins &lt;- read_csv("https://raw.githubusercontent.com/allisonhorst/palmerpenguins/main/inst/extdata/penguins_raw.csv")

library(janitor)
library(tidyverse)
library(ggbeeswarm)

penguins %&gt;% 
  clean_names() %&gt;% 
  mutate(year= format(as.Date(date_egg, format="%Y-%m-%d"),"%Y")) %&gt;% 
  filter(!is.na(sex)) %&gt;% 
  filter(!is.na(culmen_length_mm)) %&gt;% 
  mutate(species= ifelse(species=="Adelie Penguin (Pygoscelis adeliae)", "Adelie", ifelse(species=="Gentoo penguin (Pygoscelis papua)", "Gentoo", "Chinstrap")))  %&gt;% 
  ggplot() +
  aes(x = species, y = culmen_length_mm) +
  geom_boxplot( colour = "red")+
  geom_quasirandom(alpha = 0.1)+
  labs(x = "Species",
       y = "Culmen Length (mm)",
       title = "Palmer Penguins",
       subtitle = "Culmen Length (mm) by penguin species",
       caption = "Created by Natalia Umansky")+
  theme_light()

```

]]

.pull-right[

&lt;img src="figs/unnamed-chunk-19-1.png" width="130%" height="170%" /&gt;


]

---
## .fancy[General advice] - Saving plots 

* Save plots as PDF (vector graphic and small size) 


```r
ggsave("boxplot.pdf", my_boxplot, width = 5, height = 7)
```

---


## Sources and Resources

`ggplot2`: elegant graphics for data analysis  
- 3rd-edition book freely accessible online!

[ggplot2.tidyverse.org](ggplot2.tidyverse.org)  
- `Tidyverse` reference documentation is A+  

Packages used in this presentation:

```r
library(palmerpenguins)
library(dplyr)
library(ggplot2)
library(janitor)
```

---

&lt;center&gt;

.font200[.fancy[Thank you!]

&lt;br&gt;

<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M256 352C293.2 352 319.2 334.5 334.4 318.1C343.3 308.4 358.5 307.7 368.3 316.7C378 325.7 378.6 340.9 369.6 350.6C347.7 374.5 309.7 400 256 400C202.3 400 164.3 374.5 142.4 350.6C133.4 340.9 133.1 325.7 143.7 316.7C153.5 307.7 168.7 308.4 177.6 318.1C192.8 334.5 218.8 352 256 352zM208.4 208C208.4 225.7 194 240 176.4 240C158.7 240 144.4 225.7 144.4 208C144.4 190.3 158.7 176 176.4 176C194 176 208.4 190.3 208.4 208zM304.4 208C304.4 190.3 318.7 176 336.4 176C354 176 368.4 190.3 368.4 208C368.4 225.7 354 240 336.4 240C318.7 240 304.4 225.7 304.4 208zM512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM256 48C141.1 48 48 141.1 48 256C48 370.9 141.1 464 256 464C370.9 464 464 370.9 464 256C464 141.1 370.9 48 256 48z"/></svg>]

&lt;/center&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%<br>",
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<script>
  (function() {
    var divHTML = document.querySelectorAll(".details-open");
    divHTML.forEach(function (el) {
      var preNodes = el.getElementsByTagName("pre");
      var outputNode = preNodes[1];
      outputNode.outerHTML = "<details open class='output'><summary>Run</summary>" + outputNode.outerHTML + "</details>";
    })
  })();
(function() {
  var divHTML = document.querySelectorAll(".details");
  divHTML.forEach(function (el) {
    var preNodes = el.getElementsByTagName("pre");
    var outputNode = preNodes[1];
    outputNode.outerHTML = "<details class='output'><summary>Run</summary>" + outputNode.outerHTML + "</details>";
  })
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
